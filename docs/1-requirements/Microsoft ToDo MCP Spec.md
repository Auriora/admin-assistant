 # Microsoft To Do MCP (Middleware/Connector/Proxy) - Requirements Specification                                                                                                                                                          
                                                                                                                                                                                                                                          
 ## Purpose                                                                                                                                                                                                                               
 Enable true parity and collaboration between digital personal assistant(s) and the user, ensuring both see the exact same tasks, flagged emails, and planned list as the To Do app/Outlook, with no loss or mismatch.                    
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 1. Functional Requirements                                                                                                                                                                                                            
                                                                                                                                                                                                                                          
 ### 1.1. Parity with Microsoft To Do App                                                                                                                                                                                                 
                                                                                                                                                                                                                                          
 - **Requirement:** The MCP service must fully replicate the views seen in Microsoft To Do, including “Tasks,” “Planned,” “Flagged Emails,” “Important,” and any custom/smart lists.                                                      
 - **Justification:** Assistants and user must share an identical workspace for trust, reliability, and collaborative workflows.                                                                                                          
                                                                                                                                                                                                                                          
 ### 1.2. Flagged Email Synchronization                                                                                                                                                                                                   
                                                                                                                                                                                                                                          
 - **Requirement:** The MCP must enumerate all flagged emails, regardless of their folder, flag type, or threading/conversation status.                                                                                                   
     - Include items from Inbox, Sent, Archive, custom folders, and deep conversation threads.                                                                                                                                            
     - Must distinguish completed/unflagged vs. active/flagged.                                                                                                                                                                           
 - **Justification:** Many “critical” actions originate as flagged emails; missing any risks productivity, deadlines, or collaboration failures.                                                                                          
                                                                                                                                                                                                                                          
 ### 1.3. Support for Paging/Large Lists                                                                                                                                                                                                  
                                                                                                                                                                                                                                          
 - **Requirement:** MCP must reliably retrieve all items in all lists, supporting automatic paging for long lists with no artificial truncation.                                                                                          
 - **Justification:** Without this, users and assistants will see different numbers of tasks, leading to “dropped” items.                                                                                                                 
                                                                                                                                                                                                                                          
 ### 1.4. Complete Date Field Surface                                                                                                                                                                                                     
                                                                                                                                                                                                                                          
 - **Requirement:** For each task/flagged email, MCP must expose:                                                                                                                                                                         
     - dueDateTime                                                                                                                                                                                                                        
     - startDateTime                                                                                                                                                                                                                      
     - reminderDateTime                                                                                                                                                                                                                   
     - completedDateTime                                                                                                                                                                                                                  
     - createdDateTime                                                                                                                                                                                                                    
     - lastModifiedDateTime                                                                                                                                                                                                               
 - **Justification:** “Planned,” “Today,” and all smart list logic require accurate date fields for sorting, alerting, and collaboration.                                                                                                 
                                                                                                                                                                                                                                          
 ### 1.5. Linked Resources and Original Context                                                                                                                                                                                           
                                                                                                                                                                                                                                          
 - **Requirement:** Each task, especially flagged emails, must surface:                                                                                                                                                                   
     - Original Outlook/Exchange ID and conversation ID                                                                                                                                                                                   
     - Web link(s) to source email/message                                                                                                                                                                                                
     - Whether it is a forward, reply, or conversation thread child                                                                                                                                                                       
 - **Justification:** Assistants and users often need to “jump back” to the exact context for reviews, meetings, or follow-up.                                                                                                            
                                                                                                                                                                                                                                          
 ### 1.6. Support for Categories/Tags and Attachments                                                                                                                                                                                     
                                                                                                                                                                                                                                          
 - **Requirement:** Surface any tags/categories and whether an email/task has attachments.                                                                                                                                                
 - **Justification:** Enables categorization, context filtering, or preparatory work (for example, to attach docs when sending a reminder).                                                                                               
                                                                                                                                                                                                                                          
 ### 1.7. Robust Filtering and Search                                                                                                                                                                                                     
                                                                                                                                                                                                                                          
 - **Requirement:** Provide fast, reliable filtering/search by:                                                                                                                                                                           
     - Status (active, completed, deferred, waiting)                                                                                                                                                                                      
     - Date ranges (overdue, today, this week)                                                                                                                                                                                            
     - Subject line/partial text (ex: “MTN Documents”)                                                                                                                                                                                    
     - Linked resource source/folder                                                                                                                                                                                                      
 - **Justification:** Enables efficient assistant workflow and reporting.                                                                                                                                                                 
                                                                                                                                                                                                                                          
 ### 1.8. Push/Sync Support                                                                                                                                                                                                               
                                                                                                                                                                                                                                          
 - **Recommendation:** Support webhooks or polling for near-real-time reflection of changes in Outlook/To Do app (additions, completions, flag changes, deleted tasks).                                                                   
 - **Justification:** Enables assistants to react instantly to user actions, avoids stale advice, and synchronizes mobile and web interactions.                                                                                           
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 2. Technical Requirements                                                                                                                                                                                                             
                                                                                                                                                                                                                                          
 ### 2.1. Authentication/Authorization                                                                                                                                                                                                    
                                                                                                                                                                                                                                          
 - **Requirement:** Must use secure OAuth2 (or equivalent), with permission scopes suitable for reading/writing tasks, email flags, and mailbox data as needed.                                                                           
     - Should support user-specific scopes and/or delegated service accounts for shared/collaborative use.                                                                                                                                
                                                                                                                                                                                                                                          
 ### 2.2. API Design                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 - **Requirement:** Expose a RESTful API and/or GraphQL endpoint to return fully enriched task/flag metadata (including above requirements).                                                                                              
     - Should allow paging, custom field selection, and advanced server-side queries.                                                                                                                                                     
                                                                                                                                                                                                                                          
 ### 2.3. Resilience and Fallback                                                                                                                                                                                                         
                                                                                                                                                                                                                                          
 - **Requirement:** Retry logic for API calls, error surfaces for partial results, clear “staleness” warning if API tokens expire.                                                                                                        
                                                                                                                                                                                                                                          
 ### 2.4. Logging and Audit                                                                                                                                                                                                               
                                                                                                                                                                                                                                          
 - **Recommendation:** Provide an access log (who, when, what) for sanitized metadata to support troubleshooting, privacy, and security.                                                                                                  
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 3. Collaboration/PA Value-Add Features                                                                                                                                                                                                
                                                                                                                                                                                                                                          
 ### 3.1. Parity “Diff” Tool                                                                                                                                                                                                              
 - **Recommendation:** Option to compare a “To Do App” snapshot and the MCP/PA result for parity (with reporting of discrepancies).                                                                                                       
 - **Justification:** Quickly surfaces hidden sync errors.                                                                                                                                                                                
                                                                                                                                                                                                                                          
 ### 3.2. Assistant/Shared Workflows                                                                                                                                                                                                      
 - **Recommendation:** Flag tasks as “reviewed,” “discussed,” “PA actioned,” or “waiting for user,” and surface to both sides.                                                                                                            
 - **Justification:** Streamlines human/AI handoffs.                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ### 3.3. User Feedback/Override                                                                                                                                                                                                          
 - **Recommendation:** Allow custom user notes/overrides on tasks visible to assistants (manual priority, context, etc.)                                                                                                                  
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 4. Implementation Notes & Justification                                                                                                                                                                                               
                                                                                                                                                                                                                                          
 - True parity is essential for trust and optimal collaboration—current Microsoft To Do API is not sufficient, especially with flagged emails or smart lists.                                                                             
 - Assistant/User misalignment results in missed reminders, dropped work, and workflow confusion.                                                                                                                                         
 - Forward/backward compatibility is key—proposed MCP should “pass through” any new Outlook/To Do field(s) as Microsoft evolves.                                                                                                          
 - Consider future extensibility to other task/email ecosystems (Gmail, Exchange on-prem, etc.).                                                                                                                                          
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 5. Good Ideas/Future Extensions                                                                                                                                                                                                       
                                                                                                                                                                                                                                          
 - **Natural Language Export/Import:** e.g. “Export summary of overdue flagged emails for planning meeting.”                                                                                                                              
 - **Custom Analytics:** Digest/stats on overdue, due soon, always-flagged, never-actioned, etc.                                                                                                                                          
 - **Integration Hooks:** For Slack, Teams, mobile notifications, etc.                                                                                                                                                                    
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## 6. File Storage/Export                                                                                                                                                                                                                
                                                                                                                                                                                                                                          
 - **Requirement:** MCP should have an endpoint (or CLI command) to export/backup requirements, settings, status snapshots, or logs to disk as Markdown, JSON, or CSV.                                                                    
                                                                                                                                                                                                                                          
 ---                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
 ## Next Steps                                                                                                                                                                                                                            
                                                                                                                                                                                                                                          
 - Review for completeness; adjust for your specific dev environment/stack.                                                                                                                                                               
 - Decide on initial PoC: what’s most valuable for you as PA+user?                                                                                                                                                                        
 - Optionally: build a UI “parity dashboard” for human/PA troubleshooting.                                                                                                                                                                
                                                                                                                                                                                                                                          
 ---                                                                                                        